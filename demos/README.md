# Demo
 
This demo showcases how to use Keycloak to authenticate and authorize users to access protected endpoints.  

1. Spring boot echo - Open application to be protected by Keycloak using Gatekeeper as an authentication/authorization proxy. This application echos all requests.
   * [http://localhost:7070/.../...](http://localhost:7070/.../...) 

2. Spring boot oauth2 client - application with a configured Keycloak OpenID client which handles authentication and authorization directly by the application. Users sign in/out using a browser. This application contains a few pages, some public, others protected by "admin" role.
   * [http://localhost:7071](http://localhost:7071) - open to all users
   * [http://localhost:7071/customers](http://localhost:7071/customers) - protected to users with "admin" role

3. Spring boot resource server - application with protected resources using OAuth2 tokens which are generated by Keycloak using Gatekeeper. This application contains endpoints protected by "admin" role.
   * [http://localhost:7072/api/customers](http://localhost:7071/api/customers) - protected to users with "admin" role

**Prerequisites:** 
* [Docker](https://docs.docker.com/get-docker/)
* [Docker Compose](https://docs.docker.com/compose/install/)

### Start the Application

To start the application run:
```shell
docker compose up -d --build
```

### Configuration

Import realm.json into Keycloak.

### Nginx

Nginx is configured to accept requests and redirect to Gatekeeper which redirects to the backend application once user is authenticated.  
Nginx is running at port 80.  
[localhost/api/customers](http://localhost/api/customers)


### Documentation

- https://spring.io/guides/gs/securing-web/
- https://www.keycloak.org/docs/latest/authorization_services/index.html
- https://www.keycloak.org/docs/latest/server_admin/
- https://gogatekeeper.github.io/gatekeeper/userguide/
- https://gogatekeeper.github.io/gatekeeper/configuration/